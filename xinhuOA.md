The file upload vulnerability of xinhu2.2.1 has a whitelist
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/1.png "1")


Vulnerability analysis: Files outside the whitelist are changed to the uptemp suffix and have an id attribute
The content of the uploaded file is base64 encoded
But check webmain\task\runt\qcloudCosAction.php Tencent cloud storage under the qcloudCosClassAction run method
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/2.png "1")

The suffix and content are restored, then the idea of this vulnerability is to upload, and then grab the packet to obtain the id of the uploaded webshell, and then visit the following URL, change the id, you can restore the content of the php file.
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/3.png "1")
The first step: Upload the capture package, using a sentence Trojan: 666.php, the content is as follows
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/4.png "1")
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/5.png "1")
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/6.png "1")

Step 2: go to http://www.xinhu2.com:81/task.php? m=qcloudCos|runt&a=run&fileid=19
You can see the file path and generate php with the same name
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/7.png "1")
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/8.png "1")
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/9.png "1")
![1](https://github.com/Maverickfir/xinhuOAVulnerability-recurrence/blob/main/10.png "1")